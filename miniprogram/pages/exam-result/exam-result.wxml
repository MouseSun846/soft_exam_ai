<!-- exam-result.wxml -->

<!-- é¡µé¢å¤´ -->
<view class="page-header">
  <text class="page-header-title">æµ‹è¯•ç»“æœ</text>
</view>
<view class="page-header-placeholder"></view>

<view class="container">
  <!-- æ€»ä½“å¾—åˆ† -->
  <view class="score-section">
    <view class="score-card">
      <view class="score-display">
        <view class="score-circle">
          <text class="score-value">{{examResult.score}}</text>
          <text class="score-unit">åˆ†</text>
        </view>
        <text class="score-grade">{{examResult.grade}}</text>
        <text class="score-desc">æ‚¨åœ¨{{examResult.totalQuestions}}é“é¢˜ç›®ä¸­ç­”å¯¹äº†{{examResult.correctCount}}é“</text>
      </view>

      <view class="score-breakdown">
        <view class="breakdown-item">
          <text class="breakdown-value">{{examResult.fillScore}}/{{examResult.fillTotal}}</text>
          <text class="breakdown-label">å¡«ç©ºé¢˜å¾—åˆ†</text>
        </view>
        <view class="breakdown-item">
          <text class="breakdown-value">{{examResult.essayScore}}/{{examResult.essayTotal}}</text>
          <text class="breakdown-label">é—®ç­”é¢˜å¾—åˆ†</text>
        </view>
      </view>
    </view>
  </view>

  <!-- é¢˜ç›®è¯¦ç»†åˆ†æ -->
  <view class="analysis-section">
    <view class="analysis-card">
      <view class="section-header">
        <text class="section-title">é€é¢˜åˆ†æ</text>
      </view>

      <view class="question-analysis">
        <block wx:for="{{examResult.questions}}" wx:key="id">
          <view class="analysis-item {{item.status}}">
            <view class="item-header">
              <view class="status-badge {{item.status}}">{{item.statusText}}</view>
              <text class="question-meta">ç¬¬{{item.id}}é¢˜ â€¢ {{item.typeText}}</text>
            </view>
            
            <view class="question-content">
              <text class="question-text">{{item.question}}</text>
              
              <view class="answer-comparison">
                <view class="answer-item">
                  <text class="answer-label">æ‚¨çš„ç­”æ¡ˆï¼š</text>
                  <text class="answer-text {{item.status === 'correct' ? 'correct' : 'wrong'}}">{{item.userAnswer}}</text>
                </view>
                <view class="answer-item" wx:if="{{item.status !== 'correct'}}">
                  <text class="answer-label">å‚è€ƒç­”æ¡ˆï¼š</text>
                  <text class="answer-text correct">{{item.correctAnswer}}</text>
                </view>
              </view>

              <!-- é—®ç­”é¢˜AIè¯„ä¼° -->
              <view class="ai-feedback" wx:if="{{item.type === 'essay'}}">
                <text class="feedback-label">AIè¯„ä¼°ï¼š</text>
                <text class="feedback-text">{{item.aiFeedback}}</text>
              </view>
            </view>
          </view>
        </block>
      </view>
    </view>
  </view>

  <!-- AIç»¼åˆè¯„ä¼° -->
  <view class="summary-section">
    <view class="summary-card">
      <view class="section-header">
        <text class="section-title">AIç»¼åˆè¯„ä¼°ä¸å¤ä¹ å»ºè®®</text>
      </view>

      <view class="knowledge-assessment">
        <text class="assessment-title">çŸ¥è¯†æŒæ¡æƒ…å†µ</text>
        <view class="knowledge-list">
          <block wx:for="{{examResult.knowledgeAssessment}}" wx:key="topic">
            <view class="knowledge-item">
              <text class="topic-name">{{item.topic}}</text>
              <text class="topic-level {{item.level}}">{{item.levelText}}</text>
            </view>
          </block>
        </view>
      </view>

      <view class="review-suggestions">
        <text class="suggestions-title">å¤ä¹ å»ºè®®</text>
        <view class="suggestions-list">
          <block wx:for="{{examResult.reviewSuggestions}}" wx:key="id">
            <view class="suggestion-item">
              <text class="suggestion-icon">ğŸ’¡</text>
              <text class="suggestion-text">{{item.text}}</text>
            </view>
          </block>
        </view>
      </view>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-section">
    <view class="action-buttons">
      <button class="action-btn retest-btn" bindtap="retest">é‡æ–°æµ‹è¯•</button>
      <button class="action-btn home-btn" bindtap="goHome">è¿”å›é¦–é¡µ</button>
    </view>
  </view>
</view>

<!-- åº•éƒ¨æ‚¬æµ®èœå• -->
<bottom-tabbar current-tab="{{2}}"></bottom-tabbar>