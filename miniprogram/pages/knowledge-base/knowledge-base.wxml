<!-- knowledge-base.wxml -->

<!-- 页面头 -->
<view class="page-header">
  <text class="page-header-title">知识库</text>
</view>
<view class="page-header-placeholder"></view>

<view class="container">
  <!-- 搜索和操作栏 -->
  <view class="search-section">
    <view class="search-box">
      <input 
        class="search-input" 
        placeholder="搜索文档名称或内容关键词..."
        bindinput="onSearchInput"
        value="{{searchKeyword}}"
      />
      <text class="search-icon">🔍</text>
    </view>
    <button class="upload-btn" bindtap="uploadDocument">上传文档</button>
  </view>

  <!-- 上传区域 -->
  <view class="upload-section" bindtap="uploadDocument">
    <view class="upload-content">
      <text class="upload-icon">📄</text>
      <text class="upload-title">上传复习资料</text>
      <text class="upload-desc">支持 .txt, .doc, .docx, .md, .pdf 格式</text>
    </view>
  </view>

  <!-- 文档列表 -->
  <view class="document-section">
    <view class="section-header">
      <text class="section-title">我的文档</text>
      <text class="document-count">{{filteredDocuments.length}} 个文档</text>
    </view>

    <view class="document-list">
      <block wx:for="{{filteredDocuments}}" wx:key="id">
        <view class="document-item" bindtap="viewDocument" data-id="{{item.id}}">
          <view class="document-icon {{item.status}}">{{item.icon}}</view>
          <view class="document-info">
            <text class="document-name">{{item.name}}</text>
            <view class="document-meta">
              <text class="document-type">{{item.type}}</text>
              <text class="document-time">{{item.time}}</text>
            </view>
          </view>
          <view class="document-status {{item.status}}">
            <text class="status-text">{{item.statusText}}</text>
            <view wx:if="{{item.status === 'parsing'}}" class="loading-spinner"></view>
          </view>
        </view>
      </block>
    </view>
  </view>
</view>

<!-- 底部悬浮菜单 -->
<bottom-tabbar current-tab="{{1}}"></bottom-tabbar>

<!-- 上传弹窗 -->
<view class="upload-modal {{showUploadModal ? 'show' : ''}}">
  <view class="modal-content">
    <view class="modal-header">
      <text class="modal-title">选择上传方式</text>
      <text class="modal-close" bindtap="closeUploadModal">×</text>
    </view>
    <view class="upload-options">
      <view class="upload-option" bindtap="chooseFromWechat">
        <text class="option-icon">💬</text>
        <text class="option-title">微信聊天记录</text>
        <text class="option-desc">从微信聊天中选择文件</text>
      </view>
      <view class="upload-option" bindtap="chooseFromLocal">
        <text class="option-icon">📱</text>
        <text class="option-title">手机本地文件</text>
        <text class="option-desc">从手机存储中选择</text>
      </view>
    </view>
  </view>
</view>