<!-- knowledge-base-detail.wxml -->
<navigation-bar title="çŸ¥è¯†åº“è¯¦æƒ…" background-color="#3b82f6" color="#ffffff"></navigation-bar>

<view class="container">
  <!-- çŸ¥è¯†åº“ä¿¡æ¯ -->
  <view class="knowledge-header">
    <view class="knowledge-thumb">
      <image class="thumb-img" src="{{knowledgeBase.thumbnail || '/images/default-knowledge.png'}}" mode="aspectFill"></image>
    </view>
    <view class="knowledge-info">
      <view class="knowledge-header-row">
        <text class="knowledge-name">{{knowledgeBase.name}}</text>
      </view>
      <view class="knowledge-meta">
        <text class="document-count">{{knowledgeBase.documentCount}} ä¸ªæ–‡æ¡£</text>
        <text class="knowledge-time">æ›´æ–°äº {{knowledgeBase.updatedAt}}</text>
      </view>
      <text class="knowledge-description">{{knowledgeBase.description}}</text>
    </view>
    <view class="knowledge-actions">
      <button class="delete-icon-btn" bindtap="deleteKnowledgeBase">ğŸ—‘ï¸</button>
    </view>
  </view>

  <!-- ä¸Šä¼ åŒºåŸŸ -->
  <view class="upload-section" bindtap="uploadDocument">
    <view class="upload-content">
      <text class="upload-icon">ğŸ“„</text>
      <text class="upload-title">ä¸Šä¼ å¤ä¹ èµ„æ–™</text>
      <text class="upload-desc">æ”¯æŒ .txt, .doc, .docx, .md, .pdf æ ¼å¼</text>
    </view>
  </view>

  <!-- æ–‡æ¡£åˆ—è¡¨ -->
  <view class="document-section">
    <view class="section-header">
      <text class="section-title">æ–‡æ¡£åˆ—è¡¨</text>
      <text class="document-count">{{filteredDocuments.length}} ä¸ªæ–‡æ¡£</text>
    </view>

    <view class="search-box">
      <input 
        class="search-input" 
        placeholder="æœç´¢æ–‡æ¡£..."
        bindinput="onDocumentSearch"
        value="{{documentSearchKeyword}}"
      />
      <text class="search-icon">ğŸ”</text>
    </view>

    <view class="document-list">
      <block wx:for="{{filteredDocuments}}" wx:key="id">
        <view class="document-item">
          <view class="document-icon {{item.status}}">{{item.icon}}</view>
          <view class="document-info" bindtap="viewDocument" data-id="{{item.id}}">
            <text class="document-name">{{item.name}}</text>
            <view class="document-meta">
              <text class="document-type">{{item.type}}</text>
              <text class="document-size">{{item.size}}</text>
            </view>
            <view class="document-progress">
              <view class="progress-bar">
                <view class="progress-fill" style="width: {{item.progress}}%"></view>
              </view>
              <text class="progress-text">{{item.progress}}%</text>
            </view>
          </view>
          <view class="document-status {{item.status}}">
            <text class="status-text">{{item.statusText}}</text>
            <view wx:if="{{item.status === 'parsing'}}" class="loading-spinner"></view>
          </view>
          <button class="delete-doc-btn" bindtap="deleteDocument" data-id="{{item.id}}">åˆ é™¤</button>
        </view>
      </block>
    </view>
  </view>
</view>

<!-- ä¸Šä¼ å¼¹çª— -->
<view class="upload-modal {{showUploadModal ? 'show' : ''}}">
  <view class="modal-content">
    <view class="modal-header">
      <text class="modal-title">é€‰æ‹©ä¸Šä¼ æ–¹å¼</text>
      <text class="modal-close" bindtap="closeUploadModal">Ã—</text>
    </view>
    <view class="upload-options">
      <view class="upload-option" bindtap="chooseFromWechat">
        <text class="option-icon">ğŸ’¬</text>
        <text class="option-title">å¾®ä¿¡èŠå¤©è®°å½•</text>
        <text class="option-desc">ä»å¾®ä¿¡èŠå¤©ä¸­é€‰æ‹©æ–‡ä»¶</text>
      </view>
      <view class="upload-option" bindtap="chooseFromLocal">
        <text class="option-icon">ğŸ“±</text>
        <text class="option-title">æ‰‹æœºæœ¬åœ°æ–‡ä»¶</text>
        <text class="option-desc">ä»æ‰‹æœºå­˜å‚¨ä¸­é€‰æ‹©</text>
      </view>
    </view>
  </view>
</view>